<script data-provider="sitecues-proxy" type="application/javascript">
    // This loader can be used for testing sitecues locally
    var sitecues = window.sitecues = window.sitecues || {};
    sitecues.config = sitecues.config || {};
    sitecues.config.siteId = '{{{SITE_ID}}}';
    // New (with minicore) -- TODO? replace /dev/ with /`export SITECUES_JS_BRANCH=`git rev-parse --abbrev-ref HEAD`/
    sitecues.config.appUrl = {
        branch : 'default'
        // version : 'bar'
    };
    sitecues.config.scriptUrl = 'https://{{{JS_HOSTNAME}}}/sitecues-core/s;id=' + sitecues.config.siteId + '/' 
      + (sitecues.config.appUrl.branch || 'master') + '/' + (sitecues.config.appUrl.version || 'latest') + '/js/sitecues.js';
    // Old (without minicore)
    // sitecues.config.scriptUrl = '//{{{JS_HOSTNAME}}}/js/sitecues.js';
    sitecues.config.isTester = true;  // Metrics from this user can be filtered out by backend
    // Do not allow the sitecues object to be wiped out or changed to something else,
    // but allow properties to be added to it, e.g. sitecues.$ = jQuery
    Object.defineProperty(window, 'sitecues', { writable: false });
    Object.defineProperty(sitecues, 'config', { writable: false }); // Do not allow reassignment, e.g. sitecues.config = {};
    (function () {
        var script = document.createElement('script'),
            first  = document.getElementsByTagName('script')[0];
        script.type  = 'application/javascript';
        script.src   = sitecues.config.scriptUrl;
        first.parentNode.insertBefore(script, first);
    })();        
</script>
